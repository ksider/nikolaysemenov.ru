<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FTIR Merger</title>
  <link rel="stylesheet" href="styles.css">
  <script src="./d3.min.js"></script>
</head>
<body>
  <div class="bg-accent"></div>
  <div class="app-shell">
    <header class="topbar surface">
      <div class="brand">
        <img src="logo.png" alt="FTIR Merger logo" class="brand-logo" />
        <div class="brand-copy">
          <p class="eyebrow">Spectra workspace</p>
          <strong>FTIR viewer</strong>
        </div>
      </div>
      <div class="topbar-form">
        <div class="chain-group">
          <div class="field field--compact field--files">
            <label class="visually-hidden" for="files" data-i18n="filesLabel">Files (.txt):</label>
            <input id="files" class="chain-input chain-input--left" type="file" accept=".txt" multiple>
          </div>
          <div class="field field--compact field--sample">
            <label class="visually-hidden" for="sampleIndex" data-i18n="sampleIndex">Sample index (optional):</label>
            <input id="sampleIndex" class="chain-input chain-input--mid" type="text" placeholder="e.g. A1">
          </div>
          <div class="field field--compact field--filename">
            <label class="visually-hidden" for="fileName" data-i18n="fileName">Output file name (.csv):</label>
            <input id="fileName" class="chain-input chain-input--mid" type="text" value="merged.csv">
          </div>
          <button id="mergeBtn" class="btn primary chain-button chain-button--right" data-i18n="mergeBtn">Merge</button>
        </div>
      </div>
      <div class="lang-switch">
        <a href="#" class="lang-link" data-lang="en">EN</a>
        <a href="#" class="lang-link" data-lang="ru">RU</a>
        <a href="#" class="lang-link" data-lang="sr">SR</a>
      </div>
    </header>

    <div class="card surface">
      <div class="inline-row inline-row--sub">
        <p class="helper">Multi-select supported. Each column will match the file name.</p>
        <div class="status-block">
          <div id="status"></div>
          <div id="downloadLink"></div>
        </div>
      </div>

      <div class="chart-row is-hidden" id="chartRow">
        <div>
          <div id="zoneHint" class="zone-hint"></div>
          <div id="chart"></div>
        </div>
        <div class="legend-wrap">
          <div id="chartLegend" class="legend"></div>
          <div id="chartControls" class="controls">
            <h3 data-i18n="chartSettings">Chart settings</h3>
            <div class="control-group">
              <label data-i18n="xRange">X range (reverse):</label>
              <div class="inline-inputs">
                <input id="xMax" type="number" value="4000" step="1" disabled>
                <span>→</span>
                <input id="xMin" type="number" value="500" step="1" disabled>
              </div>
            </div>
            <div class="control-group">
              <label data-i18n="yRange">Y range:</label>
              <div class="inline-inputs">
                <input id="yMin" type="number" step="0.1" placeholder="auto" disabled>
                <span>→</span>
                <input id="yMax" type="number" step="0.1" placeholder="auto" disabled>
              </div>
            </div>
            <div class="control-actions">
              <button id="refreshChart" type="button" class="btn tonal" disabled data-i18n="refresh">Refresh chart</button>
              <button id="resetZoom" type="button" class="btn tonal" disabled data-i18n="resetZoom">Reset zoom</button>
              <button id="saveCsv" type="button" class="btn success" disabled data-i18n="saveCsv">Save CSV</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card surface peaks-card">
      <div class="peaks-header">
        <h3 data-i18n="peaksTitle">Peaks / stripes</h3>
        <div class="peaks-actions">
          <button id="addStripe" type="button" class="btn tonal" data-i18n="addStripe">Add stripe</button>
          <button id="copyStripes" type="button" class="btn tonal" data-i18n="copyStripes">Copy table</button>
          <p class="peaks-hint" data-i18n="peakHint">Click the chart to place a marker, then add it here.</p>
        </div>
      </div>
      <div class="peaks-table">
        <div class="peaks-row peaks-head">
          <span> </span>
          <span data-i18n="colWave">Wavenumber</span>
          <span data-i18n="colLabel">Label</span>
          <span data-i18n="colTip">Tip</span>
          <span> </span>
        </div>
        <div id="peaksEmpty" class="peaks-empty" data-i18n="peaksEmpty">No stripes yet. Set a marker and add it here.</div>
        <div id="peaksBody" class="peaks-body"></div>
      </div>
    </div>
  </div>

  <script src="./config.js"></script>
  <script src="./peak-db.js"></script>
  <script src="./app.js"></script>
</body>
</html>
